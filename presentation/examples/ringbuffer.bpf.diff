 if (ppid != parent_pid)
     return 0;

-char command[MAX_COMMAND];
-bpf_probe_read_str(command, MAX_COMMAND
+struct event e;
+e.pid = pid;
+e.ppid = ppid;
+bpf_probe_read_str(e.command, MAX_COMMAND,
    ctx + (ctx->__data_loc_filename & 0xFFFF));
+bpf_ringbuf_output(&events, &e, sizeof e, 0);
-bpf_printk("Execing %s pid: %d ppid: %d", command, pid, ppid);

 return 0;

